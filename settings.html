<div id="lilith-assistant-settings" class="inline-drawer">
    <div class="inline-drawer-toggle inline-drawer-header">
        <b>莉莉丝助手 (Lilith Assistant)</b>
        <div class="inline-drawer-icon fa-solid fa-circle-chevron-down"></div>
    </div>
    <div class="inline-drawer-content">
        <div class="settings_section">
            <p style="font-size: 0.9em; opacity: 0.8;">人格化的 AI 吐槽助手。您可以设置吐槽的频率、位置以及开启/关闭各项功能。</p>
        </div>

        <hr class="sysHR" />

        <!-- 系统与版本 -->
        <div class="settings_section">
            <h4 style="margin: 5px 0; opacity: 0.9;">系统状态</h4>
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                <div style="display: flex; align-items: center; gap: 6px;">
                    <span style="font-weight: bold; font-size: 0.85em;">当前版本:</span>
                    <span id="lilith-version-info" style="font-size: 0.85em; opacity: 0.7; font-family: monospace;">v3.0.5</span>
                </div>
                <button id="lilith-manual-update-btn" class="menu_button" style="margin: 0; padding: 2px 12px; height: 30px; font-size: 0.85em;">检查更新</button>
            </div>
            
            <label for="lilith-persona-select">活动人格切换:</label>
            <select id="lilith-persona-select" class="text_pole">
                <option value="toxic">毒舌 (默认)</option>
                <option value="wife">贤惠</option>
                <option value="brat">小鬼</option>
                <option value="imouto">妹妹</option>
                <option value="meme">模英</option>
            </select>
        </div>

        <hr class="sysHR" />

        <!-- 核心逻辑设置 -->
        <div class="settings_section">
            <h4 style="margin: 5px 0; opacity: 0.9;">核心逻辑</h4>
            <div style="margin-bottom: 10px;">
                <label for="lilith-comment-frequency">吐槽触发概率 (0-100%):</label>
                <div class="flex-container alignItemCenter">
                    <input type="range" id="lilith-comment-frequency" min="0" max="100" step="1" style="flex: 1; margin-right: 10px;">
                    <span id="lilith-freq-value" style="min-width: 40px; text-align: right;">0%</span>
                </div>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="lilith-comment-mode">回复插入位置:</label>
                <select id="lilith-comment-mode" class="text_pole">
                    <option value="random">自动定位 (智能注入)</option>
                    <option value="bottom">始终追加在末尾</option>
                    <option value="top">始终置于顶端</option>
                </select>
            </div>

            <div class="flex-container alignItemCenter">
                <input type="checkbox" id="lilith-auto-send">
                <label for="lilith-auto-send">智能选项自动发送</label>
            </div>
        </div>

        <hr class="sysHR" />

        <!-- OMNI-LINK 看板 -->
        <div class="settings_section">
            <h4 style="margin: 5px 0; opacity: 0.9;">全域链路看版</h4>
            <div class="flex-container alignItemCenter">
                <input type="checkbox" id="lilith-inject-dashboard">
                <label for="lilith-inject-dashboard">在 AI 回复末尾注入 OMNI-LINK 看板</label>
            </div>
            <div style="margin-top: 5px;">
                <label for="lilith-dashboard-style">默认视觉风格 (仅全局生效):</label>
                <select id="lilith-dashboard-style" class="text_pole">
                    <option value="modern">莉莉丝粉 (默认)</option>
                    <option value="parchment">古籍羊皮</option>
                    <option value="ink">泼墨山水</option>
                    <option value="terminal">矩阵终端</option>
                    <option value="industrial">重工业风</option>
                </select>
            </div>
        </div>

        <hr class="sysHR" />

        <!-- 内容净化设置 -->
        <div class="settings_section">
            <h4 style="margin: 5px 0; opacity: 0.9;">内容净化 (净化正则)</h4>
            
            <div style="margin-bottom: 10px; background: rgba(0, 243, 255, 0.05); padding: 10px; border: 1px solid rgba(0, 243, 255, 0.2); border-radius: 4px;">
                <label style="font-size: 0.85em; font-weight: bold;">方案预设管理</label>
                <div class="flex-container alignItemCenter" style="gap: 5px; margin-top: 5px;">
                    <select id="lilith-regex-preset-select" class="text_pole" style="flex: 1; height: 30px;">
                        <option value="">载入预设...</option>
                    </select>
                    <button id="lilith-regex-save" class="menu_button" style="width: auto; padding: 0 10px;">保存预设</button>
                    <button id="lilith-regex-delete" class="menu_button" style="width: auto; padding: 0 10px; color: #ff5555;">删除</button>
                </div>
                <div style="margin-top: 5px; display: none;" id="lilith-regex-name-container">
                    <input type="text" id="lilith-regex-new-name" class="text_pole" placeholder="输入新方案名称..." style="height: 25px; font-size: 0.8em;">
                </div>
            </div>

            <div style="margin-bottom: 10px;">
                <div class="flex-container alignItemCenter">
                    <input type="checkbox" id="lilith-extraction-enabled">
                    <label for="lilith-extraction-enabled">启用正文提取 (切除前后缀)</label>
                </div>
                <input type="text" id="lilith-extraction-regex" class="text_pole" placeholder="例如: <正文>|</正文>">
            </div>

            <div style="margin-bottom: 10px;">
                <div class="flex-container alignItemCenter">
                    <input type="checkbox" id="lilith-text-replacement-enabled">
                    <label for="lilith-text-replacement-enabled">启用文字正则替换</label>
                </div>
                <div style="display: flex; gap: 5px;">
                    <input type="text" id="lilith-text-replacement-regex" class="text_pole" placeholder="需替换的正则" style="flex: 2;">
                    <input type="text" id="lilith-text-replacement-string" class="text_pole" placeholder="替换为..." style="flex: 1;">
                </div>
            </div>
            
            <div style="margin-top:10px; border: 1px solid var(--SmartThemeBorderColor); padding: 8px; border-radius: 4px; background: rgba(0,0,0,0.1);">
                <label style="font-weight:bold; font-size: 0.85em;">净化效果测试</label>
                <textarea id="lilith-extraction-test-input" class="text_pole" rows="2" placeholder="输入测试文本..." style="margin:5px 0; width:100%; box-sizing:border-box;"></textarea>
                <button id="lilith-extraction-test-btn" class="menu_button" style="width: 100%;">运行测试</button>
                <div id="lilith-extraction-test-result" style="margin-top:8px; background: rgba(0,0,0,0.2); font-size: 0.85em; padding: 5px; border-radius: 4px; border: 1px dashed rgba(255,255,255,0.1); min-height: 20px; font-family: monospace;"></div>
            </div>
        </div>

        <hr class="sysHR" />

        <!-- 大脑皮层与动态生成 -->
        <div class="settings_section">
            <h4 style="margin: 5px 0; opacity: 0.9; color: #bd00ff;">大脑皮层 (AI 动态内容)</h4>
            <div class="flex-container alignItemCenter">
                <input type="checkbox" id="lilith-dynamic-enabled">
                <label for="lilith-dynamic-enabled">启用实时构思 (自动生成对话与事件)</label>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <div style="flex: 1;">
                    <label style="font-size: 0.85em;">运行间隔 (分钟)</label>
                    <input type="number" id="lilith-dynamic-interval" class="text_pole" min="1" max="4320">
                </div>
                <div style="flex: 1;">
                    <label style="font-size: 0.85em;">单次构思条数</label>
                    <input type="number" id="lilith-dynamic-count" class="text_pole" min="1" max="20">
                </div>
            </div>

            <div style="margin-top: 10px;">
                <label for="lilith-dynamic-trigger-chance">活跃度权重 (0-100%):</label>
                <input type="range" id="lilith-dynamic-trigger-chance" min="0" max="100" step="5">
                <div style="display: flex; justify-content: space-between; font-size: 0.75em; opacity: 0.6;">
                    <span>低频触发</span>
                    <span id="lilith-dyn-trigger-val">100%</span>
                    <span>极高活跃</span>
                </div>
            </div>

            <div style="margin-top: 15px; display: flex; gap: 5px;">
                <button id="lilith-force-generate-dynamic" class="menu_button" style="flex: 1;">立即构思内容</button>
                <button id="lilith-test-dynamic-trigger" class="menu_button" style="flex: 1;">手动触发测试</button>
            </div>
        </div>

        <hr class="sysHR" />

        <!-- 视觉展示与安全 -->
        <div class="settings_section">
            <h4 style="margin: 5px 0; opacity: 0.9;">界面展示与安全</h4>
            
            <div class="flex-container alignItemCenter">
                <input type="checkbox" id="lilith-hide-avatar">
                <label for="lilith-hide-avatar">隐藏全屏挂件 (仅保留正文渲染)</label>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <div style="flex: 2;">
                    <label style="font-size: 0.85em;">挂件尺寸 (px)</label>
                    <input type="number" id="lilith-avatar-size" class="text_pole" min="50" max="500">
                </div>
                <div style="flex: 3;">
                    <label style="font-size: 0.85em;">锁定延迟 (分钟)</label>
                    <input type="number" id="lilith-auto-lock" class="text_pole" min="0" max="1440">
                </div>
            </div>

            <div style="margin-top: 15px; display: flex; gap: 5px;">
                <button id="lilith-reset-pos" class="menu_button" style="flex: 1;">重置锚点位置</button>
                <button id="lilith-toggle-panel" class="menu_button" style="flex: 1;">展开面板</button>
            </div>
        </div>

        <hr class="sysHR" />

        <div class="settings_section">
            <button id="lilith-reset-state" class="menu_button" style="color: #ff5555; border-color: rgba(255, 85, 85, 0.3); width: 100%;">
                危险：清空好感度与所有记忆
            </button>
        </div>
    </div>
</div>
