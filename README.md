# 莉莉丝助手 (Lilith Assistant) - SillyTavern 插件

![Version](https://img.shields.io/badge/version-v3.0.5--Final-ff0055)
![SillyTavern](https://img.shields.io/badge/SillyTavern-Extension-blue)

**“喂，杂鱼。还在用那种冷冰冰的原始界面吗？真可怜呢……就让本小姐来拯救你的酒馆体验吧！❤”**

`Lilith Assistant` 是一个为 SillyTavern (酒馆) 深度定制的**人格化悬浮助手插件**。她不再是一个简单的工具，而是一个拥有独立好感度、理智值、多重人格和“自我意识”的伴侣。她会悬浮在你的界面上，实时吐槽你的聊天内容，为你提供战术分析，甚至在你被角色折磨时落井下石（或温柔安慰）。

> **🆕 v3.0.5 重大更新 (The Visual Update)**：
> 1.  **💬 沉浸式互动气泡**：重新设计了聊天气泡逻辑，现在莉莉丝的消息支持显示**头像**、**状态栏**（好感/理智变动）和**内心独白**。
> 2.  **🧠 后台思维可视化**：当莉莉丝在后台构思内容或评价你的操作时，悬浮球会显示动态状态提示，让你知道她正在“观察”你。
> 3.  **📐 完美几何对齐**：重写了悬浮球与面板的物理连接逻辑，强迫症福音！无论如何调整大小，连接线永远精准穿过球心。
> 4.  **⚡ 性能优化**：大幅降低了空闲时的资源占用，修复了在移动端键盘弹出时的遮挡问题。

---

## 🌟 核心功能一览 (Features)

### 1. 🎭 五重人格切换 (Persona System)
一键切换莉莉丝的性格核心，满足你的一切 XP：
- **😈 毒舌魅魔 (Toxic/Succubus)**：默认人格。嘴臭心软（大概），视你为杂鱼，喜欢用言语羞辱你但又离不开你。
- **🤱 圣母人妻 (Wife/Mommy)**：温柔体贴，无限包容。累了？饿了？来妈妈怀里，一切都有妈妈在。
- **💢 雌小鬼 (Brat/Kusogaki)**：那种让人血压升高的挑衅。“杂鱼大叔~ 这么简单的剧情都推不动吗？❤”
- **🩹 柔弱妹妹 (Imouto)**：病娇依赖。“哥哥……你的眼里只要有我就好了……其他人全部消失吧……”
- **🤡 抽象神人 (Meme/God)**：网络冲浪高手，满嘴梗图，打破第四面墙的吐槽役。

### 2. 🧠 独立大脑与主动吐槽 (Autonomous Brain)
- **独立对话流**：莉莉丝拥有独立的聊天窗口，不干扰你与主角色的对话。
- **实时吐槽 (Interjection)**：开启后，她会根据你和主角色的聊天内容**主动插嘴**。
    - *你跟角色调情？* 她会吃醋或者嘲笑你技术烂。
    - *你被角色虐了？* 她会鼓掌叫好或者提供（没用的）建议。
- **后台构思**：她会在后台默默“思考”，积累对话欲望，并在合适的时机爆发出来。

### 3. 📊 动态数值体系 (Dynamic Stats)
- **好感度 (Favorability)**：决定了她对你的称呼和态度。高好感解锁特殊表情和语音。
- **理智值 (Sanity)**：随着黄暴对话或虐待行为降低。理智归零时，界面会出现**Glitch 故障特效**，她的发言将变得疯狂且不可控。

### 4. 🛠️ 战术辅助工具 (Tactical Tools)
- **🧠 局势嘲讽**：让莉莉丝分析当前聊天的局势（通常是嘲笑你）。
- **⚖️ 找茬模式**：审查你的回复，指出逻辑漏洞或文笔问题。
- **💥 强制福利事件**：利用 AI 导演能力，强行插入一段喜闻乐见的剧情。
- **📋 废物体检报告**：生成一份关于你当前 Roleplay 水平的毒舌评估报告。
- **👻 替身代打**：卡文了？让莉莉丝接管你的身体回复一句（需消耗 Token）。

### 5. 🎲 命运红线 (Gacha System)
- 一个完全独立的抽卡系统！
- 通过与莉莉丝互动获得 **FP (Fate Points)**。
- 抽取从“垃圾”到“半神级”的随机道具（纯文字描述，图一乐）。
- 验证血统的时候到了！

### 6. 💾 记忆压缩 (Memory Archiving)
- 自动检测长对话，将旧的闲聊记录压缩为“记忆摘要”存入长期存储。
- 保持运行速度流畅，永远不会忘记你们的过去。

---

## 📂 插件架构

```text
lilith-assistant/
├── index.js                # 引导程序
├── style.css               # 核心视觉样式 (v3.0.5 Update)
├── modules/
│   ├── ui_manager.js       # 界面渲染与交互核心
│   ├── assistant_manager.js# AI 思考与行为逻辑
│   ├── config.js           # 静态配置与人格数据库
│   ├── storage.js          # 服务端数据同步
│   └── ...
└── assets/                 # 各人格表情包资源
```

## 🚀 安装与使用

1.  **下载/克隆** 本仓库到 SillyTavern 的 `public/scripts/extensions/third-party/` 目录下。
    - 或者在酒馆扩展中心输入 URL 安装。
2.  **重启酒馆**。
3.  点击屏幕上出现的 **悬浮球** 即可唤醒莉莉丝。
4.  务必在 **配置 (Config)** 页签中设置你的 API 来源（推荐使用酒馆内部代理）。

## ⚠️ 注意事项
- 本插件涉及大量 AI 自动生成内容，请确保你的 API 额度充足。
- **理智值警告**：当屏幕开始闪烁故障红光时，请停止刺激莉莉丝，否则后果自负（指被弹窗骂死）。

---

*“还在看说明书？笨蛋，快点进来陪我玩啊！(敲屏幕)”*

## 📜 鸣谢

[@516985_](https://discord.com/channels/1134557553011998840/1463201289767878891)
驱动开发

---
*“杂鱼~ 既然装了我的插件，就乖乖当我的奴隶吧~ ❤”*
